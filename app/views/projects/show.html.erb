<% title(@project.name, "Project") %>

<div class="page-header">

    <h1><%= @project.name + " Project" %></h1>
    
    <ul class="actions">
        <% if policy(@project).update? %>
            <li>
                <%= link_to "Edit Project", edit_project_path(@project), class: "edit" %>
            </li>
        <% end %>
        
        <% admins_only do%>
            <li>
                <%= link_to "Delete Project", 
                    admin_project_path(@project),
                    method: :delete,
                    class: "delete",
                    data: { confirm:
                            "Are you sure you want to delete this project?" 
                          } %>
            </li>
        <% end %>
    </ul>
</div>

<h1><%= @project.name %></h1>
<p><%= @project.description %></p>

<div class="page-header">
    <h2>Tickets</h2>
    
    <ul class="actions">
        <% if policy(Ticket.new(project: @project)).create? %>
            <li><%= link_to "New Ticket",
                new_project_ticket_path(@project),
                class: "new" %>
            </li>
        <% end %>
    </ul>
</div>

<ul id="tickets">
    <% @project.tickets.each do |ticket| %>
        <li>
            #<%= ticket.id %> -
            <%= link_to ticket.title, [@project, ticket] %>
            <%= render ticket.state if ticket.state %>
        </li>
    <% end %>
</ul>
